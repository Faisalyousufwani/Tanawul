<%- include('../includes/admin/adminHead.ejs') %>
  <%- include('../includes/admin/adminNavbar.ejs') %>
    <style>
      .dropdown-menu a:hover {
        color: white !important;
        cursor: pointer;
      }

      .pagination-btn {
        padding: 50px;
        width: 100%;
        display: flex;
        justify-content: center;
      }

      .pagination-btn a {
        text-decoration: none;
        color: #ececec;
      }

      .pagination-btn a :hover {
        color: #111;
      }

      .pagination-btn button:hover {
        color: #111;
      }

      .pagination-btn button:active {
        background-color: #fff;
        color: #111 !important;
      }
    </style>

    <div class="main-panel">
      <div class="content-wrapper">

        <div class=" row   mt-3">

          <div class="col-12 col-sm-6">
            <div class="row m-0">
              <div class="col-md-6">
                <div class="form-group row">
                  <div class="col-sm-12">
                    <form action="/admin/restaurant-list">
                      <select class="form-control" name="sortData">
                        <option value="title">Title</option>
                        <option value="location">Location</option>
                      </select>
                  </div>
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group row">
                  <div class="col-sm-12">
                    <select class="form-control" name="sortOrder">
                      <option>Ascending</option>
                      <option>Descending</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="sort form-group col-md-4 "><button class=" btn btn-primary form-control">
                  sort
                </button></div>
              </form>
            </div>
          </div>

        </div>

        <div class="row mt-5">
          <div class="col-12 grid-margin">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">Restaurants</h4>
                <div class="table-responsive">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Title</th>
                        <th>foods</th>
                        <th>Date</th>
                        <th>Location</th>
                        <th>Contact</th>
                        <th>email</th>
                        <th>Status</th>
                        <th>Manage</th>
                      </tr>
                    </thead>
                    <tbody>

                      <% for ( let restaurant of restaurants ) { %>
                        <tr>

                          <td>
                            <%=restaurant?.title%>
                          </td>
                          <td>
                           <% for(y of restaurant?.foods){ %>
                            <%= y?.name %>
                              <% } %>
                          </td>
                           <td>
                            <%=restaurant?.time%>
                          </td>
                          <td>
                            <%= restaurant.location.address %>
                          </td>
                          <td>
                            <%= restaurant.contact %>
                          </td>
                          <td id="order-status-<%= restaurant._id %>">
                           <%=restaurant.owner.email %>
                          </td>
                          <td>
                            <%= restaurant.isApprved%>
                          </td>
                          <td>
                           <% if(restaurant.isApproved){%>
                            <a href="/admin/restaurant/block/<%= restaurant._id %>" class="btn btn-secondary"> Unlist</a>
                            <% }else{ %>
                              <a href="/admin/restaurant/approve/<%= restaurant._id %>" class="btn btn-secondary"> Approve</a>
                              <% } %>
                          </td>
                       

                        </tr>
                        <% } %>

                    </tbody> 
                  </table>
                </div>
              </div>
            </div>

            <!-- Pagination buttons -->
            <div class="pagination-btn">
              <% if( currentPage !==1 ) { %>
                <a
                  href="/admin/restaurant-list?page=1<% if ( sortData ) {%>&sortData=<%= sortData %><% } %><% if ( sortOrder ) {%>&sortOrder=<%= sortOrder %><% } %>"><button
                    type="button" class="btn btn-outline-secondary 1">1</button></a>
                <% } %>
                  <% if( currentPage> 2 ) { %>
                    <a
                      href="/admin/restaurant-list?page=<%= prevPage %><% if ( sortData ) {%>&sortData=<%= sortData %><% } %><% if ( sortOrder ) {%>&sortOrder=<%= sortOrder %><% } %>"><button
                        type="button" class="btn btn-outline-secondary 2">
                        <%= prevPage %>
                      </button></a>
                    <% } %>
                      <a
                        href="/admin/orders?page=<%= currentPage %><% if ( sortData ) {%>&sortData=<%= sortData %><% } %><% if ( sortOrder ) {%>&sortOrder=<%= sortOrder %><% } %>"><button
                          type="button" class="btn btn-outline-secondary 3 active">
                          <%= currentPage %>
                        </button></a>
                      <% if( hasNextPage ) { %>
                        <a
                          href="/admin/restaurant-list?page=<%= nextPage %><% if ( sortData ) {%>&sortData=<%= sortData %><% } %><% if ( sortOrder ) {%>&sortOrder=<%= sortOrder %><% } %>"><button
                            type="button" class="btn btn-outline-secondary 4">
                            <%= nextPage %>
                          </button></a>
                        <% } %>
                          <% if( nextPage !==lastPage && currentPage !==lastPage ) { %>
                            <a
                              href="/admin/restaurant-list?page=<%= lastPage %><% if ( sortData ) {%>&sortData=<%= sortData %><% } %><% if ( sortOrder ) {%>&sortOrder=<%= sortOrder %><% } %>"><button
                                type="button" class="btn btn-outline-secondary 5">
                                <%= lastPage %>
                              </button></a>
                            <% } %>
            </div>

          </div>
        </div>

      </div>
    </div>
    </div>
    </div>

    <!-- The popup message modal -->
    <div id="popupModal" class="modal fade" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-light text-dark">
          <div class="modal-body">
            <h5 id="modalHead" class="modal-title"></h5><br>
            <p id="modalContent"></p>
          </div>
        </div>
      </div>
    </div>


 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>

  
    <%- include('../includes/admin/adminFooter.ejs') %>
